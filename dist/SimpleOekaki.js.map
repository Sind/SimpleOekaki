{"version":3,"sources":["webpack:///webpack/bootstrap a179ebc6af930665bdc0","webpack:///./SimpleOekaki.js","webpack:////home/srodk/Repos/SimpleOekaki/node_modules/iro.js/src/iro.js","webpack:////home/srodk/Repos/SimpleOekaki/node_modules/sortablejs/Sortable.js","webpack:///./SimpleOekakiCanvas.js","webpack:///../glsl/canvas.vsh","webpack:///../glsl/canvas.fsh","webpack:///../glsl/layer.vsh","webpack:///../glsl/layer.fsh","webpack:///./utils.js"],"names":["SimpleOekakiCanvas","require","utils","SimpleOekaki","div","tagName","Error","maindiv","document","createElement","classList","add","setAttribute","optionsholder","canvasholder","toprow","bottomrow","_incSizeButton","innerHTML","_decSizeButton","_sizeSlider","step","value","DEFAULT_BRUSH_SIZE","min","MIN_BRUSH_SIZE","max","MAX_BRUSH_SIZE","_layerMenuOpenButton","_backgroundColorSelector","RGBtoHTML","backgroundColor","_invisibleLayerMenuOverlay","_layerMenu","layerMenuOptionsHolder","layerMenuOptionsRow","_layerMenuCloseButton","_layerList","_layers","forEach","layer","index","text","label","options","visibilityButton","colorSelect","appendChild","create","_backgroundLayer","_invisibleColorMenuOverlay","_colorMenu","colorMenuOptionsHolder","colorMenuOptionsRow","_colorMenuCloseButton","colorPickerHolder","id","append","_colorPicker","ColorPicker","_setHTMLInputCallbacks","brushSize","getAttribute","remove","addEventListener","parseInt","HTMLtoRGB","openLayerMenu","closeLayerMenu","closeColorMenu","Array","prototype","call","getElementsByClassName","parentNode","currentLayer","module","exports","window","Color","Stylesheet","ColorWheel","sortableModule","factory","define","sortableFactory","sortableError","dragEl","parentEl","ghostEl","cloneEl","rootEl","nextEl","lastDownEl","scrollEl","scrollParentEl","scrollCustomFn","lastEl","lastCSS","lastParentCSS","oldIndex","newIndex","activeGroup","putSortable","autoScroll","tapEvt","touchEvt","moved","R_SPACE","R_FLOAT","expando","Date","getTime","win","$","jQuery","Zepto","Polymer","captureMode","supportDraggable","supportCssPointerEvents","el","navigator","userAgent","match","style","cssText","pointerEvents","_silent","abs","Math","savedInputChecked","touchDragOverListeners","_autoScroll","_throttle","evt","scroll","_this","rect","sens","scrollSensitivity","speed","scrollSpeed","x","clientX","y","clientY","winWidth","innerWidth","winHeight","innerHeight","vx","vy","scrollOffsetX","scrollOffsetY","scrollFn","offsetWidth","scrollWidth","offsetHeight","scrollHeight","getBoundingClientRect","right","left","bottom","top","clearInterval","pid","setInterval","scrollTo","pageXOffset","pageYOffset","scrollTop","scrollLeft","_prepareGroup","toFn","pull","group","name","to","from","fromGroup","join","indexOf","originalGroup","checkPull","checkPut","put","revertClone","Sortable","nodeType","toString","_extend","defaults","random","sort","disabled","store","handle","draggable","test","nodeName","ghostClass","chosenClass","dragClass","ignore","filter","preventOnFilter","animation","setData","dataTransfer","textContent","dropBubble","dragoverBubble","dataIdAttr","delay","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","fn","charAt","bind","nativeDraggable","_on","_onTapStart","push","_onDragOver","get","constructor","type","touch","touches","target","originalTarget","shadowRoot","path","startIndex","_saveInputCheckedState","button","_closest","_index","_dispatchEvent","preventDefault","split","some","criteria","trim","_prepareDragStart","ownerDocument","dragStartFn","nextSibling","_lastX","_lastY","_disableDelayedDrag","_toggleClass","_triggerDragStart","_find","_disableDraggable","_onDrop","_dragStartTimer","setTimeout","clearTimeout","_off","pointerType","_onDragStart","selection","empty","getSelection","removeAllRanges","err","_dragStarted","active","_nulling","_emulateDragOver","_css","elementFromPoint","parent","i","length","_onTouchMove","dx","dy","translate3d","_appendGhost","css","ghostRect","cloneNode","marginTop","marginLeft","width","height","body","useFallback","_offUpEvents","_clone","insertBefore","_loopId","effectAllowed","dragRect","targetRect","revert","activeSortable","isOwner","isMovingBetweenSortable","canSort","stopPropagation","animated","contains","lastPullMode","_cloneHide","children","_ghostIsLast","lastElementChild","_onMove","_animate","floating","cssFloat","display","isWide","isLong","halfway","nextElementSibling","after","elTop","offsetTop","tgTop","previousElementSibling","moveVector","_unsilent","prevRect","ms","currentRect","removeChild","save","checked","handleEvent","_globalDragOver","toArray","order","n","_generateId","items","set","closest","selector","option","destroy","querySelectorAll","removeAttribute","splice","sortable","state","ctx","_matches","_getParentOrHost","host","dropEffect","event","removeEventListener","className","replace","prop","val","defaultView","getComputedStyle","currentStyle","iterator","list","getElementsByTagName","targetEl","fromEl","createEvent","onName","toUpperCase","substr","initEvent","item","clone","dispatchEvent","toEl","originalEvt","willInsertAfter","onMoveFn","onMove","retVal","dragged","draggedRect","related","relatedRect","str","src","href","sum","charCodeAt","tag","shift","re","RegExp","callback","args","arguments","apply","dst","key","hasOwnProperty","dom","root","inputs","idx","Object","defineProperty","capture","passive","on","off","find","is","extend","throttle","toggleClass","version","VERSION","DEFAULT_BACKGROUND_COLOR","DEFAULT_LAYER_COLOR","_diameter","_backgroundColor","_currentLayer","_layerOrder","_layerColors","_layerVisibility","_canvas","_initializeGL","_gl","_setInputCallbacks","colors","_onLayerColorChange","x0","y0","x1","y1","useProgram","_layerShaderProgram","bindFramebuffer","FRAMEBUFFER","_canvasFBO","uniform4f","_fragmentLineUniform","round","uniform1f","_fragmentSizeUniform","drawArrays","TRIANGLE_STRIP","_canvasShaderProgram","clearColor","clear","COLOR_BUFFER_BIT","uniform3fv","_fragmentBackgroundColorUniform","uniform3iv","_fragmentLayerOrderUniform","_fragmentLayerVisibilityUniform","uniformMatrix3fv","_fragmentLayerColorsUniform","concat","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","log","getShaderInfoLog","canvasBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","vertexAttribPointer","_vertexPositionAttribute2","FLOAT","_vertexPositionAttribute","createFramebuffer","_canvasTexture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","RGBA","UNSIGNED_BYTE","framebufferTexture2D","COLOR_ATTACHMENT0","fsh","vsh","vertexShader","_getShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","VertexPositionAttribute","getAttribLocation","enableVertexAttribArray","_initShaderProgram","getUniformLocation","isDown","currentMousePos","getMouse","e","bbox","mx","my","startEvent","paintLine","moveEvent","nextPos","targetTouches","cancelBubble","getContext","viewport","_initShaders","_initBuffers","self","paintGL","colorArray","_onCurrentLayerChange","size","_onBrushSizeChange","DECtoHEX","c","hex","htmlcolor","map","v","rgbcolor"],"mappings":"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","file":"SimpleOekaki.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/test\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a179ebc6af930665bdc0","\n\n// const fs = require('fs');\nimport iro from 'iro.js';\nimport Sortable from 'sortablejs';\n\nconst SimpleOekakiCanvas = require('./SimpleOekakiCanvas.js');\nconst utils = require('./utils.js');\n\nclass SimpleOekaki extends SimpleOekakiCanvas {\n  constructor(div) {\n    if (div == null || div.tagName !== 'DIV') {\n      throw new Error('You must provide a div as input parameter.');\n    }\n    // html\n    const maindiv = document.createElement('div');\n    maindiv.classList.add('SimpleOekaki');\n    maindiv.setAttribute('oncontextmenu', 'return false;');\n    const optionsholder = document.createElement('div');\n    optionsholder.classList.add('optionsholder');\n    const canvasholder = document.createElement('div');\n    canvasholder.classList.add('canvasholder');\n    const toprow = document.createElement('div');\n    toprow.classList.add('optionsrow');\n    const bottomrow = document.createElement('div');\n    bottomrow.classList.add('optionsrow');\n    super(canvasholder);\n\n    this._incSizeButton = document.createElement('i');\n    this._incSizeButton.classList.add('material-icons');\n    this._incSizeButton.classList.add('option');\n    this._incSizeButton.innerHTML = 'add';\n\n    this._decSizeButton = document.createElement('i');\n    this._decSizeButton.classList.add('material-icons');\n    this._decSizeButton.classList.add('option');\n    this._decSizeButton.innerHTML = 'remove';\n\n    this._sizeSlider = document.createElement('input');\n    this._sizeSlider.setAttribute('type', 'range');\n    this._sizeSlider.classList.add('option');\n    this._sizeSlider.step = 2;\n    this._sizeSlider.value = SimpleOekakiCanvas.DEFAULT_BRUSH_SIZE;\n    this._sizeSlider.min = SimpleOekakiCanvas.MIN_BRUSH_SIZE;\n    this._sizeSlider.max = SimpleOekakiCanvas.MAX_BRUSH_SIZE;\n\n    this._layerMenuOpenButton = document.createElement('i');\n    this._layerMenuOpenButton.classList.add('material-icons');\n    this._layerMenuOpenButton.classList.add('option');\n    this._layerMenuOpenButton.innerHTML = 'layers';\n\n    this._backgroundColorSelector = document.createElement('input');\n    this._backgroundColorSelector.setAttribute('type', 'color');\n    this._backgroundColorSelector.setAttribute('value', utils.RGBtoHTML(this.backgroundColor));\n\n    this._invisibleLayerMenuOverlay = document.createElement('div');\n    this._invisibleLayerMenuOverlay.classList.add('invisible-overlay');\n    this._invisibleLayerMenuOverlay.classList.add('hidden');\n\n    this._layerMenu = document.createElement('div');\n    this._layerMenu.classList.add('layer-menu');\n    this._layerMenu.classList.add('hidden');\n\n    const layerMenuOptionsHolder = document.createElement('div');\n    layerMenuOptionsHolder.classList.add('optionsholder');\n\n    const layerMenuOptionsRow = document.createElement('div');\n    layerMenuOptionsRow.classList.add('optionsrow');\n    layerMenuOptionsRow.classList.add('reverse');\n\n    this._layerMenuCloseButton = document.createElement('i');\n    this._layerMenuCloseButton.classList.add('material-icons');\n    this._layerMenuCloseButton.classList.add('option');\n    this._layerMenuCloseButton.innerHTML = 'close';\n\n    this._layerList = document.createElement('div');\n    this._layerList.classList.add('layer-list');\n    this._layerList.classList.add('list-group');\n\n    this._layers = [\n      document.createElement('div'),\n      document.createElement('div'),\n      document.createElement('div'),\n    ];\n\n    this._layers.forEach((layer, index) => {\n      layer.classList.add('layer');\n      layer.classList.add('list-group-item');\n      layer.classList.add('optionsholder');\n      layer.setAttribute('data-layer-id', 2 - index);\n      if (index === 0) layer.classList.add('selected');\n\n      const text = document.createElement('div');\n      text.classList.add('optionsrow');\n      text.classList.add('layer-selector');\n\n      const label = document.createElement('div');\n      label.classList.add('option');\n      label.classList.add('label');\n      label.innerHTML = `Layer ${3 - index}`;\n\n      const options = document.createElement('div');\n      options.classList.add('optionsrow');\n\n      const visibilityButton = document.createElement('i');\n      visibilityButton.classList.add('material-icons');\n      visibilityButton.classList.add('option');\n      visibilityButton.innerHTML = 'visibility';\n\n      const colorSelect = document.createElement('div');\n      colorSelect.classList.add('color-select');\n      colorSelect.classList.add('option');\n      colorSelect.classList.add('grow');\n\n      text.appendChild(label);\n      options.appendChild(visibilityButton);\n      options.appendChild(colorSelect);\n      layer.appendChild(text);\n      layer.appendChild(options);\n      this._layerList.appendChild(layer);\n    });\n\n    Sortable.create(this._layerList);\n\n    this._backgroundLayer = document.createElement('div');\n    this._backgroundLayer.classList.add('layer');\n    this._backgroundLayer.classList.add('optionsholder');\n    this._backgroundLayer.setAttribute('data-layer-id', -1);\n\n    const text = document.createElement('div');\n    text.classList.add('optionsrow');\n    text.classList.add('layer-selector');\n\n    const label = document.createElement('div');\n    label.classList.add('option');\n    label.classList.add('label');\n    label.innerHTML = 'Background';\n\n    const options = document.createElement('div');\n    options.classList.add('optionsrow');\n\n\n    const colorSelect = document.createElement('div');\n    colorSelect.classList.add('color-select');\n    colorSelect.classList.add('option');\n    colorSelect.classList.add('grow');\n\n    text.appendChild(label);\n    this._backgroundLayer.appendChild(text);\n    options.appendChild(colorSelect);\n    this._backgroundLayer.appendChild(options);\n\n    this._invisibleColorMenuOverlay = document.createElement('div');\n    this._invisibleColorMenuOverlay.classList.add('invisible-overlay');\n    this._invisibleColorMenuOverlay.classList.add('hidden');\n\n    this._colorMenu = document.createElement('div');\n    this._colorMenu.classList.add('color-menu');\n    this._colorMenu.classList.add('hidden');\n\n    const colorMenuOptionsHolder = document.createElement('div');\n    colorMenuOptionsHolder.classList.add('optionsholder');\n\n    const colorMenuOptionsRow = document.createElement('div');\n    colorMenuOptionsRow.classList.add('optionsrow');\n    colorMenuOptionsRow.classList.add('reverse');\n\n    this._colorMenuCloseButton = document.createElement('i');\n    this._colorMenuCloseButton.classList.add('material-icons');\n    this._colorMenuCloseButton.classList.add('option');\n    this._colorMenuCloseButton.innerHTML = 'close';\n\n    const colorPickerHolder = document.createElement('div');\n    colorPickerHolder.classList.add('color-wheel-holder');\n    colorPickerHolder.id = 'color-wheel-holder';\n\n\n    div.appendChild(maindiv);\n    maindiv.appendChild(optionsholder);\n    optionsholder.appendChild(toprow);\n    optionsholder.appendChild(bottomrow);\n    toprow.appendChild(this._decSizeButton);\n    toprow.appendChild(this._sizeSlider);\n    toprow.appendChild(this._incSizeButton);\n    toprow.appendChild(this._backgroundColorSelector);\n    toprow.appendChild(this._layerMenuOpenButton);\n    maindiv.appendChild(canvasholder);\n\n    maindiv.appendChild(this._invisibleLayerMenuOverlay);\n    maindiv.appendChild(this._layerMenu);\n    this._layerMenu.appendChild(layerMenuOptionsHolder);\n    layerMenuOptionsHolder.appendChild(layerMenuOptionsRow);\n    layerMenuOptionsRow.appendChild(this._layerMenuCloseButton);\n    this._layerMenu.appendChild(this._layerList);\n    this._layerMenu.appendChild(this._backgroundLayer);\n\n    maindiv.appendChild(this._invisibleColorMenuOverlay);\n    maindiv.append(this._colorMenu);\n    this._colorMenu.appendChild(colorMenuOptionsHolder);\n    colorMenuOptionsHolder.appendChild(colorMenuOptionsRow);\n    colorMenuOptionsRow.appendChild(this._colorMenuCloseButton);\n    this._colorMenu.appendChild(colorPickerHolder);\n    this._colorPicker = new iro.ColorPicker('#color-wheel-holder');\n\n    this._setHTMLInputCallbacks();\n  }\n\n  _onBrushSizeChange(brushSize) {\n    this._sizeSlider.value = brushSize;\n  }\n\n  _onCurrentLayerChange(id) {\n    this._layers.forEach((layer) => {\n      if (id === layer.getAttribute('data-layer-id')) {\n        layer.classList.add('selected');\n      } else {\n        layer.classList.remove('selected');\n      }\n    });\n  }\n\n  _setHTMLInputCallbacks() {\n    this._decSizeButton.addEventListener('click', () => {\n      this.brushSize -= 2;\n    });\n    this._incSizeButton.addEventListener('click', () => {\n      this.brushSize += 2;\n    });\n    this._sizeSlider.addEventListener('change', () => {\n      this.brushSize = parseInt(this._sizeSlider.value, 10);\n    });\n    this._backgroundColorSelector.addEventListener('input', () => {\n      this.backgroundColor = utils.HTMLtoRGB(this._backgroundColorSelector.value);\n    });\n    this._layerMenuOpenButton.addEventListener('click', () => {\n      this.openLayerMenu();\n    });\n    this._layerMenuCloseButton.addEventListener('click', () => {\n      this.closeLayerMenu();\n    });\n    this._invisibleLayerMenuOverlay.addEventListener('click', () => {\n      this.closeLayerMenu();\n    });\n    this._colorMenuCloseButton.addEventListener('click', () => {\n      this.closeColorMenu();\n    });\n    this._invisibleColorMenuOverlay.addEventListener('click', () => {\n      this.closeColorMenu();\n    });\n\n    Array.prototype.forEach.call(document.getElementsByClassName('layer-selector'), (text) => {\n      const id = text.parentNode.getAttribute('data-layer-id');\n      if (id === -1) return;\n      text.addEventListener('click', () => {\n        this.currentLayer = id;\n      });\n    });\n  }\n  openLayerMenu() {\n    this._layerMenu.classList.remove('hidden');\n    this._invisibleLayerMenuOverlay.classList.remove('hidden');\n  }\n\n  closeLayerMenu() {\n    this._layerMenu.classList.add('hidden');\n    this._invisibleLayerMenuOverlay.classList.add('hidden');\n  }\n\n  openColorMenu() {\n    this._colorMenu.classList.remove('hidden');\n    this._invisibleColorMenuOverlay.classList.remove('hidden');\n  }\n\n  closeColorMenu() {\n    this._colorMenu.classList.add('hidden');\n    this._invisibleColorMenuOverlay.classList.add('hidden');\n  }\n}\n\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = SimpleOekaki;\n}\n\nif (window) {\n  window.SimpleOekaki = SimpleOekaki;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./SimpleOekaki.js","import colorPicker from \"modules/colorPicker\";\nimport color from \"modules/color\";\nimport stylesheet from \"modules/stylesheet\";\n\nmodule.exports = {\n  Color: color,\n  ColorPicker: colorPicker,\n  Stylesheet: stylesheet,\n  // for backwards compat\n  ColorWheel: colorPicker,\n};\n\n\n\n// WEBPACK FOOTER //\n// /home/srodk/Repos/SimpleOekaki/node_modules/iro.js/src/iro.js","/**!\n * Sortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @license MIT\n */\n\n(function sortableModule(factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(factory);\n\t}\n\telse if (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n\t\tmodule.exports = factory();\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\twindow[\"Sortable\"] = factory();\n\t}\n})(function sortableFactory() {\n\t\"use strict\";\n\n\tif (typeof window == \"undefined\" || !window.document) {\n\t\treturn function sortableError() {\n\t\t\tthrow new Error(\"Sortable.js requires a window with a document\");\n\t\t};\n\t}\n\n\tvar dragEl,\n\t\tparentEl,\n\t\tghostEl,\n\t\tcloneEl,\n\t\trootEl,\n\t\tnextEl,\n\t\tlastDownEl,\n\n\t\tscrollEl,\n\t\tscrollParentEl,\n\t\tscrollCustomFn,\n\n\t\tlastEl,\n\t\tlastCSS,\n\t\tlastParentCSS,\n\n\t\toldIndex,\n\t\tnewIndex,\n\n\t\tactiveGroup,\n\t\tputSortable,\n\n\t\tautoScroll = {},\n\n\t\ttapEvt,\n\t\ttouchEvt,\n\n\t\tmoved,\n\n\t\t/** @const */\n\t\tR_SPACE = /\\s+/g,\n\t\tR_FLOAT = /left|right|inline/,\n\n\t\texpando = 'Sortable' + (new Date).getTime(),\n\n\t\twin = window,\n\t\tdocument = win.document,\n\t\tparseInt = win.parseInt,\n\n\t\t$ = win.jQuery || win.Zepto,\n\t\tPolymer = win.Polymer,\n\n\t\tcaptureMode = false,\n\n\t\tsupportDraggable = !!('draggable' in document.createElement('div')),\n\t\tsupportCssPointerEvents = (function (el) {\n\t\t\t// false when IE11\n\t\t\tif (!!navigator.userAgent.match(/Trident.*rv[ :]?11\\./)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tel = document.createElement('x');\n\t\t\tel.style.cssText = 'pointer-events:auto';\n\t\t\treturn el.style.pointerEvents === 'auto';\n\t\t})(),\n\n\t\t_silent = false,\n\n\t\tabs = Math.abs,\n\t\tmin = Math.min,\n\n\t\tsavedInputChecked = [],\n\t\ttouchDragOverListeners = [],\n\n\t\t_autoScroll = _throttle(function (/**Event*/evt, /**Object*/options, /**HTMLElement*/rootEl) {\n\t\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n\t\t\tif (rootEl && options.scroll) {\n\t\t\t\tvar _this = rootEl[expando],\n\t\t\t\t\tel,\n\t\t\t\t\trect,\n\t\t\t\t\tsens = options.scrollSensitivity,\n\t\t\t\t\tspeed = options.scrollSpeed,\n\n\t\t\t\t\tx = evt.clientX,\n\t\t\t\t\ty = evt.clientY,\n\n\t\t\t\t\twinWidth = window.innerWidth,\n\t\t\t\t\twinHeight = window.innerHeight,\n\n\t\t\t\t\tvx,\n\t\t\t\t\tvy,\n\n\t\t\t\t\tscrollOffsetX,\n\t\t\t\t\tscrollOffsetY\n\t\t\t\t;\n\n\t\t\t\t// Delect scrollEl\n\t\t\t\tif (scrollParentEl !== rootEl) {\n\t\t\t\t\tscrollEl = options.scroll;\n\t\t\t\t\tscrollParentEl = rootEl;\n\t\t\t\t\tscrollCustomFn = options.scrollFn;\n\n\t\t\t\t\tif (scrollEl === true) {\n\t\t\t\t\t\tscrollEl = rootEl;\n\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tif ((scrollEl.offsetWidth < scrollEl.scrollWidth) ||\n\t\t\t\t\t\t\t\t(scrollEl.offsetHeight < scrollEl.scrollHeight)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\t\t} while (scrollEl = scrollEl.parentNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (scrollEl) {\n\t\t\t\t\tel = scrollEl;\n\t\t\t\t\trect = scrollEl.getBoundingClientRect();\n\t\t\t\t\tvx = (abs(rect.right - x) <= sens) - (abs(rect.left - x) <= sens);\n\t\t\t\t\tvy = (abs(rect.bottom - y) <= sens) - (abs(rect.top - y) <= sens);\n\t\t\t\t}\n\n\n\t\t\t\tif (!(vx || vy)) {\n\t\t\t\t\tvx = (winWidth - x <= sens) - (x <= sens);\n\t\t\t\t\tvy = (winHeight - y <= sens) - (y <= sens);\n\n\t\t\t\t\t/* jshint expr:true */\n\t\t\t\t\t(vx || vy) && (el = win);\n\t\t\t\t}\n\n\n\t\t\t\tif (autoScroll.vx !== vx || autoScroll.vy !== vy || autoScroll.el !== el) {\n\t\t\t\t\tautoScroll.el = el;\n\t\t\t\t\tautoScroll.vx = vx;\n\t\t\t\t\tautoScroll.vy = vy;\n\n\t\t\t\t\tclearInterval(autoScroll.pid);\n\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tautoScroll.pid = setInterval(function () {\n\t\t\t\t\t\t\tscrollOffsetY = vy ? vy * speed : 0;\n\t\t\t\t\t\t\tscrollOffsetX = vx ? vx * speed : 0;\n\n\t\t\t\t\t\t\tif ('function' === typeof(scrollCustomFn)) {\n\t\t\t\t\t\t\t\treturn scrollCustomFn.call(_this, scrollOffsetX, scrollOffsetY, evt);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (el === win) {\n\t\t\t\t\t\t\t\twin.scrollTo(win.pageXOffset + scrollOffsetX, win.pageYOffset + scrollOffsetY);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tel.scrollTop += scrollOffsetY;\n\t\t\t\t\t\t\t\tel.scrollLeft += scrollOffsetX;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 24);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 30),\n\n\t\t_prepareGroup = function (options) {\n\t\t\tfunction toFn(value, pull) {\n\t\t\t\tif (value === void 0 || value === true) {\n\t\t\t\t\tvalue = group.name;\n\t\t\t\t}\n\n\t\t\t\tif (typeof value === 'function') {\n\t\t\t\t\treturn value;\n\t\t\t\t} else {\n\t\t\t\t\treturn function (to, from) {\n\t\t\t\t\t\tvar fromGroup = from.options.group.name;\n\n\t\t\t\t\t\treturn pull\n\t\t\t\t\t\t\t? value\n\t\t\t\t\t\t\t: value && (value.join\n\t\t\t\t\t\t\t\t? value.indexOf(fromGroup) > -1\n\t\t\t\t\t\t\t\t: (fromGroup == value)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar group = {};\n\t\t\tvar originalGroup = options.group;\n\n\t\t\tif (!originalGroup || typeof originalGroup != 'object') {\n\t\t\t\toriginalGroup = {name: originalGroup};\n\t\t\t}\n\n\t\t\tgroup.name = originalGroup.name;\n\t\t\tgroup.checkPull = toFn(originalGroup.pull, true);\n\t\t\tgroup.checkPut = toFn(originalGroup.put);\n\t\t\tgroup.revertClone = originalGroup.revertClone;\n\n\t\t\toptions.group = group;\n\t\t}\n\t;\n\n\n\t/**\n\t * @class  Sortable\n\t * @param  {HTMLElement}  el\n\t * @param  {Object}       [options]\n\t */\n\tfunction Sortable(el, options) {\n\t\tif (!(el && el.nodeType && el.nodeType === 1)) {\n\t\t\tthrow 'Sortable: `el` must be HTMLElement, and not ' + {}.toString.call(el);\n\t\t}\n\n\t\tthis.el = el; // root element\n\t\tthis.options = options = _extend({}, options);\n\n\n\t\t// Export instance\n\t\tel[expando] = this;\n\n\t\t// Default options\n\t\tvar defaults = {\n\t\t\tgroup: Math.random(),\n\t\t\tsort: true,\n\t\t\tdisabled: false,\n\t\t\tstore: null,\n\t\t\thandle: null,\n\t\t\tscroll: true,\n\t\t\tscrollSensitivity: 30,\n\t\t\tscrollSpeed: 10,\n\t\t\tdraggable: /[uo]l/i.test(el.nodeName) ? 'li' : '>*',\n\t\t\tghostClass: 'sortable-ghost',\n\t\t\tchosenClass: 'sortable-chosen',\n\t\t\tdragClass: 'sortable-drag',\n\t\t\tignore: 'a, img',\n\t\t\tfilter: null,\n\t\t\tpreventOnFilter: true,\n\t\t\tanimation: 0,\n\t\t\tsetData: function (dataTransfer, dragEl) {\n\t\t\t\tdataTransfer.setData('Text', dragEl.textContent);\n\t\t\t},\n\t\t\tdropBubble: false,\n\t\t\tdragoverBubble: false,\n\t\t\tdataIdAttr: 'data-id',\n\t\t\tdelay: 0,\n\t\t\tforceFallback: false,\n\t\t\tfallbackClass: 'sortable-fallback',\n\t\t\tfallbackOnBody: false,\n\t\t\tfallbackTolerance: 0,\n\t\t\tfallbackOffset: {x: 0, y: 0}\n\t\t};\n\n\n\t\t// Set default options\n\t\tfor (var name in defaults) {\n\t\t\t!(name in options) && (options[name] = defaults[name]);\n\t\t}\n\n\t\t_prepareGroup(options);\n\n\t\t// Bind all private methods\n\t\tfor (var fn in this) {\n\t\t\tif (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n\t\t\t\tthis[fn] = this[fn].bind(this);\n\t\t\t}\n\t\t}\n\n\t\t// Setup drag mode\n\t\tthis.nativeDraggable = options.forceFallback ? false : supportDraggable;\n\n\t\t// Bind events\n\t\t_on(el, 'mousedown', this._onTapStart);\n\t\t_on(el, 'touchstart', this._onTapStart);\n\t\t_on(el, 'pointerdown', this._onTapStart);\n\n\t\tif (this.nativeDraggable) {\n\t\t\t_on(el, 'dragover', this);\n\t\t\t_on(el, 'dragenter', this);\n\t\t}\n\n\t\ttouchDragOverListeners.push(this._onDragOver);\n\n\t\t// Restore sorting\n\t\toptions.store && this.sort(options.store.get(this));\n\t}\n\n\n\tSortable.prototype = /** @lends Sortable.prototype */ {\n\t\tconstructor: Sortable,\n\n\t\t_onTapStart: function (/** Event|TouchEvent */evt) {\n\t\t\tvar _this = this,\n\t\t\t\tel = this.el,\n\t\t\t\toptions = this.options,\n\t\t\t\tpreventOnFilter = options.preventOnFilter,\n\t\t\t\ttype = evt.type,\n\t\t\t\ttouch = evt.touches && evt.touches[0],\n\t\t\t\ttarget = (touch || evt).target,\n\t\t\t\toriginalTarget = evt.target.shadowRoot && (evt.path && evt.path[0]) || target,\n\t\t\t\tfilter = options.filter,\n\t\t\t\tstartIndex;\n\n\t\t\t_saveInputCheckedState(el);\n\n\n\t\t\t// Don't trigger start event when an element is been dragged, otherwise the evt.oldindex always wrong when set option.group.\n\t\t\tif (dragEl) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {\n\t\t\t\treturn; // only left button or enabled\n\t\t\t}\n\n\n\t\t\ttarget = _closest(target, options.draggable, el);\n\n\t\t\tif (!target) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (lastDownEl === target) {\n\t\t\t\t// Ignoring duplicate `down`\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Get the index of the dragged element within its parent\n\t\t\tstartIndex = _index(target, options.draggable);\n\n\t\t\t// Check filter\n\t\t\tif (typeof filter === 'function') {\n\t\t\t\tif (filter.call(this, evt, target, this)) {\n\t\t\t\t\t_dispatchEvent(_this, originalTarget, 'filter', target, el, startIndex);\n\t\t\t\t\tpreventOnFilter && evt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (filter) {\n\t\t\t\tfilter = filter.split(',').some(function (criteria) {\n\t\t\t\t\tcriteria = _closest(originalTarget, criteria.trim(), el);\n\n\t\t\t\t\tif (criteria) {\n\t\t\t\t\t\t_dispatchEvent(_this, criteria, 'filter', target, el, startIndex);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filter) {\n\t\t\t\t\tpreventOnFilter && evt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (options.handle && !_closest(originalTarget, options.handle, el)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Prepare `dragstart`\n\t\t\tthis._prepareDragStart(evt, touch, target, startIndex);\n\t\t},\n\n\t\t_prepareDragStart: function (/** Event */evt, /** Touch */touch, /** HTMLElement */target, /** Number */startIndex) {\n\t\t\tvar _this = this,\n\t\t\t\tel = _this.el,\n\t\t\t\toptions = _this.options,\n\t\t\t\townerDocument = el.ownerDocument,\n\t\t\t\tdragStartFn;\n\n\t\t\tif (target && !dragEl && (target.parentNode === el)) {\n\t\t\t\ttapEvt = evt;\n\n\t\t\t\trootEl = el;\n\t\t\t\tdragEl = target;\n\t\t\t\tparentEl = dragEl.parentNode;\n\t\t\t\tnextEl = dragEl.nextSibling;\n\t\t\t\tlastDownEl = target;\n\t\t\t\tactiveGroup = options.group;\n\t\t\t\toldIndex = startIndex;\n\n\t\t\t\tthis._lastX = (touch || evt).clientX;\n\t\t\t\tthis._lastY = (touch || evt).clientY;\n\n\t\t\t\tdragEl.style['will-change'] = 'transform';\n\n\t\t\t\tdragStartFn = function () {\n\t\t\t\t\t// Delayed drag has been triggered\n\t\t\t\t\t// we can re-enable the events: touchmove/mousemove\n\t\t\t\t\t_this._disableDelayedDrag();\n\n\t\t\t\t\t// Make the element draggable\n\t\t\t\t\tdragEl.draggable = _this.nativeDraggable;\n\n\t\t\t\t\t// Chosen item\n\t\t\t\t\t_toggleClass(dragEl, options.chosenClass, true);\n\n\t\t\t\t\t// Bind the events: dragstart/dragend\n\t\t\t\t\t_this._triggerDragStart(evt, touch);\n\n\t\t\t\t\t// Drag start event\n\t\t\t\t\t_dispatchEvent(_this, rootEl, 'choose', dragEl, rootEl, oldIndex);\n\t\t\t\t};\n\n\t\t\t\t// Disable \"draggable\"\n\t\t\t\toptions.ignore.split(',').forEach(function (criteria) {\n\t\t\t\t\t_find(dragEl, criteria.trim(), _disableDraggable);\n\t\t\t\t});\n\n\t\t\t\t_on(ownerDocument, 'mouseup', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchend', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'touchcancel', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'pointercancel', _this._onDrop);\n\t\t\t\t_on(ownerDocument, 'selectstart', _this);\n\n\t\t\t\tif (options.delay) {\n\t\t\t\t\t// If the user moves the pointer or let go the click or touch\n\t\t\t\t\t// before the delay has been reached:\n\t\t\t\t\t// disable the delayed drag\n\t\t\t\t\t_on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'mousemove', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'touchmove', _this._disableDelayedDrag);\n\t\t\t\t\t_on(ownerDocument, 'pointermove', _this._disableDelayedDrag);\n\n\t\t\t\t\t_this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n\t\t\t\t} else {\n\t\t\t\t\tdragStartFn();\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t},\n\n\t\t_disableDelayedDrag: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\tclearTimeout(this._dragStartTimer);\n\t\t\t_off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchend', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'mousemove', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'touchmove', this._disableDelayedDrag);\n\t\t\t_off(ownerDocument, 'pointermove', this._disableDelayedDrag);\n\t\t},\n\n\t\t_triggerDragStart: function (/** Event */evt, /** Touch */touch) {\n\t\t\ttouch = touch || (evt.pointerType == 'touch' ? evt : null);\n\n\t\t\tif (touch) {\n\t\t\t\t// Touch device support\n\t\t\t\ttapEvt = {\n\t\t\t\t\ttarget: dragEl,\n\t\t\t\t\tclientX: touch.clientX,\n\t\t\t\t\tclientY: touch.clientY\n\t\t\t\t};\n\n\t\t\t\tthis._onDragStart(tapEvt, 'touch');\n\t\t\t}\n\t\t\telse if (!this.nativeDraggable) {\n\t\t\t\tthis._onDragStart(tapEvt, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_on(dragEl, 'dragend', this);\n\t\t\t\t_on(rootEl, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\t// Timeout neccessary for IE9\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\tdocument.selection.empty();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t},\n\n\t\t_dragStarted: function () {\n\t\t\tif (rootEl && dragEl) {\n\t\t\t\tvar options = this.options;\n\n\t\t\t\t// Apply effect\n\t\t\t\t_toggleClass(dragEl, options.ghostClass, true);\n\t\t\t\t_toggleClass(dragEl, options.dragClass, false);\n\n\t\t\t\tSortable.active = this;\n\n\t\t\t\t// Drag start event\n\t\t\t\t_dispatchEvent(this, rootEl, 'start', dragEl, rootEl, oldIndex);\n\t\t\t} else {\n\t\t\t\tthis._nulling();\n\t\t\t}\n\t\t},\n\n\t\t_emulateDragOver: function () {\n\t\t\tif (touchEvt) {\n\t\t\t\tif (this._lastX === touchEvt.clientX && this._lastY === touchEvt.clientY) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._lastX = touchEvt.clientX;\n\t\t\t\tthis._lastY = touchEvt.clientY;\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', 'none');\n\t\t\t\t}\n\n\t\t\t\tvar target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY),\n\t\t\t\t\tparent = target,\n\t\t\t\t\ti = touchDragOverListeners.length;\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (parent[expando]) {\n\t\t\t\t\t\t\twhile (i--) {\n\t\t\t\t\t\t\t\ttouchDragOverListeners[i]({\n\t\t\t\t\t\t\t\t\tclientX: touchEvt.clientX,\n\t\t\t\t\t\t\t\t\tclientY: touchEvt.clientY,\n\t\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\t\trootEl: parent\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget = parent; // store last element\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\twhile (parent = parent.parentNode);\n\t\t\t\t}\n\n\t\t\t\tif (!supportCssPointerEvents) {\n\t\t\t\t\t_css(ghostEl, 'display', '');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_onTouchMove: function (/**TouchEvent*/evt) {\n\t\t\tif (tapEvt) {\n\t\t\t\tvar\toptions = this.options,\n\t\t\t\t\tfallbackTolerance = options.fallbackTolerance,\n\t\t\t\t\tfallbackOffset = options.fallbackOffset,\n\t\t\t\t\ttouch = evt.touches ? evt.touches[0] : evt,\n\t\t\t\t\tdx = (touch.clientX - tapEvt.clientX) + fallbackOffset.x,\n\t\t\t\t\tdy = (touch.clientY - tapEvt.clientY) + fallbackOffset.y,\n\t\t\t\t\ttranslate3d = evt.touches ? 'translate3d(' + dx + 'px,' + dy + 'px,0)' : 'translate(' + dx + 'px,' + dy + 'px)';\n\n\t\t\t\t// only set the status to dragging, when we are actually dragging\n\t\t\t\tif (!Sortable.active) {\n\t\t\t\t\tif (fallbackTolerance &&\n\t\t\t\t\t\tmin(abs(touch.clientX - this._lastX), abs(touch.clientY - this._lastY)) < fallbackTolerance\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._dragStarted();\n\t\t\t\t}\n\n\t\t\t\t// as well as creating the ghost element on the document body\n\t\t\t\tthis._appendGhost();\n\n\t\t\t\tmoved = true;\n\t\t\t\ttouchEvt = touch;\n\n\t\t\t\t_css(ghostEl, 'webkitTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'mozTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'msTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'transform', translate3d);\n\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t},\n\n\t\t_appendGhost: function () {\n\t\t\tif (!ghostEl) {\n\t\t\t\tvar rect = dragEl.getBoundingClientRect(),\n\t\t\t\t\tcss = _css(dragEl),\n\t\t\t\t\toptions = this.options,\n\t\t\t\t\tghostRect;\n\n\t\t\t\tghostEl = dragEl.cloneNode(true);\n\n\t\t\t\t_toggleClass(ghostEl, options.ghostClass, false);\n\t\t\t\t_toggleClass(ghostEl, options.fallbackClass, true);\n\t\t\t\t_toggleClass(ghostEl, options.dragClass, true);\n\n\t\t\t\t_css(ghostEl, 'top', rect.top - parseInt(css.marginTop, 10));\n\t\t\t\t_css(ghostEl, 'left', rect.left - parseInt(css.marginLeft, 10));\n\t\t\t\t_css(ghostEl, 'width', rect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height);\n\t\t\t\t_css(ghostEl, 'opacity', '0.8');\n\t\t\t\t_css(ghostEl, 'position', 'fixed');\n\t\t\t\t_css(ghostEl, 'zIndex', '100000');\n\t\t\t\t_css(ghostEl, 'pointerEvents', 'none');\n\n\t\t\t\toptions.fallbackOnBody && document.body.appendChild(ghostEl) || rootEl.appendChild(ghostEl);\n\n\t\t\t\t// Fixing dimensions.\n\t\t\t\tghostRect = ghostEl.getBoundingClientRect();\n\t\t\t\t_css(ghostEl, 'width', rect.width * 2 - ghostRect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height * 2 - ghostRect.height);\n\t\t\t}\n\t\t},\n\n\t\t_onDragStart: function (/**Event*/evt, /**boolean*/useFallback) {\n\t\t\tvar dataTransfer = evt.dataTransfer,\n\t\t\t\toptions = this.options;\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (activeGroup.checkPull(this, this, dragEl, evt)) {\n\t\t\t\tcloneEl = _clone(dragEl);\n\n\t\t\t\tcloneEl.draggable = false;\n\t\t\t\tcloneEl.style['will-change'] = '';\n\n\t\t\t\t_css(cloneEl, 'display', 'none');\n\t\t\t\t_toggleClass(cloneEl, this.options.chosenClass, false);\n\n\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t\t_dispatchEvent(this, rootEl, 'clone', dragEl);\n\t\t\t}\n\n\t\t\t_toggleClass(dragEl, options.dragClass, true);\n\n\t\t\tif (useFallback) {\n\t\t\t\tif (useFallback === 'touch') {\n\t\t\t\t\t// Bind touch events\n\t\t\t\t\t_on(document, 'touchmove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'touchend', this._onDrop);\n\t\t\t\t\t_on(document, 'touchcancel', this._onDrop);\n\t\t\t\t\t_on(document, 'pointermove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'pointerup', this._onDrop);\n\t\t\t\t} else {\n\t\t\t\t\t// Old brwoser\n\t\t\t\t\t_on(document, 'mousemove', this._onTouchMove);\n\t\t\t\t\t_on(document, 'mouseup', this._onDrop);\n\t\t\t\t}\n\n\t\t\t\tthis._loopId = setInterval(this._emulateDragOver, 50);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (dataTransfer) {\n\t\t\t\t\tdataTransfer.effectAllowed = 'move';\n\t\t\t\t\toptions.setData && options.setData.call(this, dataTransfer, dragEl);\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'drop', this);\n\t\t\t\tsetTimeout(this._dragStarted, 0);\n\t\t\t}\n\t\t},\n\n\t\t_onDragOver: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\ttarget,\n\t\t\t\tdragRect,\n\t\t\t\ttargetRect,\n\t\t\t\trevert,\n\t\t\t\toptions = this.options,\n\t\t\t\tgroup = options.group,\n\t\t\t\tactiveSortable = Sortable.active,\n\t\t\t\tisOwner = (activeGroup === group),\n\t\t\t\tisMovingBetweenSortable = false,\n\t\t\t\tcanSort = options.sort;\n\n\t\t\tif (evt.preventDefault !== void 0) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\t!options.dragoverBubble && evt.stopPropagation();\n\t\t\t}\n\n\t\t\tif (dragEl.animated) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmoved = true;\n\n\t\t\tif (activeSortable && !options.disabled &&\n\t\t\t\t(isOwner\n\t\t\t\t\t? canSort || (revert = !rootEl.contains(dragEl)) // Reverting item into the original list\n\t\t\t\t\t: (\n\t\t\t\t\t\tputSortable === this ||\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t(activeSortable.lastPullMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) &&\n\t\t\t\t\t\t\tgroup.checkPut(this, activeSortable, dragEl, evt)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t) &&\n\t\t\t\t(evt.rootEl === void 0 || evt.rootEl === this.el) // touch fallback\n\t\t\t) {\n\t\t\t\t// Smart auto-scrolling\n\t\t\t\t_autoScroll(evt, options, this.el);\n\n\t\t\t\tif (_silent) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\ttarget = _closest(evt.target, options.draggable, el);\n\t\t\t\tdragRect = dragEl.getBoundingClientRect();\n\n\t\t\t\tif (putSortable !== this) {\n\t\t\t\t\tputSortable = this;\n\t\t\t\t\tisMovingBetweenSortable = true;\n\t\t\t\t}\n\n\t\t\t\tif (revert) {\n\t\t\t\t\t_cloneHide(activeSortable, true);\n\t\t\t\t\tparentEl = rootEl; // actualization\n\n\t\t\t\t\tif (cloneEl || nextEl) {\n\t\t\t\t\t\trootEl.insertBefore(dragEl, cloneEl || nextEl);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!canSort) {\n\t\t\t\t\t\trootEl.appendChild(dragEl);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\n\t\t\t\tif ((el.children.length === 0) || (el.children[0] === ghostEl) ||\n\t\t\t\t\t(el === evt.target) && (_ghostIsLast(el, evt))\n\t\t\t\t) {\n\t\t\t\t\t//assign target only if condition is true\n\t\t\t\t\tif (el.children.length !== 0 && el.children[0] !== ghostEl && el === evt.target) {\n\t\t\t\t\t\ttarget = el.lastElementChild;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\tif (target.animated) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttargetRect = target.getBoundingClientRect();\n\t\t\t\t\t}\n\n\t\t\t\t\t_cloneHide(activeSortable, isOwner);\n\n\t\t\t\t\tif (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt) !== false) {\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\tparentEl = el; // actualization\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\ttarget && this._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (target && !target.animated && target !== dragEl && (target.parentNode[expando] !== void 0)) {\n\t\t\t\t\tif (lastEl !== target) {\n\t\t\t\t\t\tlastEl = target;\n\t\t\t\t\t\tlastCSS = _css(target);\n\t\t\t\t\t\tlastParentCSS = _css(target.parentNode);\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetRect = target.getBoundingClientRect();\n\n\t\t\t\t\tvar width = targetRect.right - targetRect.left,\n\t\t\t\t\t\theight = targetRect.bottom - targetRect.top,\n\t\t\t\t\t\tfloating = R_FLOAT.test(lastCSS.cssFloat + lastCSS.display)\n\t\t\t\t\t\t\t|| (lastParentCSS.display == 'flex' && lastParentCSS['flex-direction'].indexOf('row') === 0),\n\t\t\t\t\t\tisWide = (target.offsetWidth > dragEl.offsetWidth),\n\t\t\t\t\t\tisLong = (target.offsetHeight > dragEl.offsetHeight),\n\t\t\t\t\t\thalfway = (floating ? (evt.clientX - targetRect.left) / width : (evt.clientY - targetRect.top) / height) > 0.5,\n\t\t\t\t\t\tnextSibling = target.nextElementSibling,\n\t\t\t\t\t\tafter = false\n\t\t\t\t\t;\n\n\t\t\t\t\tif (floating) {\n\t\t\t\t\t\tvar elTop = dragEl.offsetTop,\n\t\t\t\t\t\t\ttgTop = target.offsetTop;\n\n\t\t\t\t\t\tif (elTop === tgTop) {\n\t\t\t\t\t\t\tafter = (target.previousElementSibling === dragEl) && !isWide || halfway && isWide;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (target.previousElementSibling === dragEl || dragEl.previousElementSibling === target) {\n\t\t\t\t\t\t\tafter = (evt.clientY - targetRect.top) / height > 0.5;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tafter = tgTop > elTop;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (!isMovingBetweenSortable) {\n\t\t\t\t\t\tafter = (nextSibling !== dragEl) && !isLong || halfway && isLong;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);\n\n\t\t\t\t\tif (moveVector !== false) {\n\t\t\t\t\t\tif (moveVector === 1 || moveVector === -1) {\n\t\t\t\t\t\t\tafter = (moveVector === 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_silent = true;\n\t\t\t\t\t\tsetTimeout(_unsilent, 30);\n\n\t\t\t\t\t\t_cloneHide(activeSortable, isOwner);\n\n\t\t\t\t\t\tif (!dragEl.contains(el)) {\n\t\t\t\t\t\t\tif (after && !nextSibling) {\n\t\t\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttarget.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparentEl = dragEl.parentNode; // actualization\n\n\t\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\t\tthis._animate(targetRect, target);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_animate: function (prevRect, target) {\n\t\t\tvar ms = this.options.animation;\n\n\t\t\tif (ms) {\n\t\t\t\tvar currentRect = target.getBoundingClientRect();\n\n\t\t\t\tif (prevRect.nodeType === 1) {\n\t\t\t\t\tprevRect = prevRect.getBoundingClientRect();\n\t\t\t\t}\n\n\t\t\t\t_css(target, 'transition', 'none');\n\t\t\t\t_css(target, 'transform', 'translate3d('\n\t\t\t\t\t+ (prevRect.left - currentRect.left) + 'px,'\n\t\t\t\t\t+ (prevRect.top - currentRect.top) + 'px,0)'\n\t\t\t\t);\n\n\t\t\t\ttarget.offsetWidth; // repaint\n\n\t\t\t\t_css(target, 'transition', 'all ' + ms + 'ms');\n\t\t\t\t_css(target, 'transform', 'translate3d(0,0,0)');\n\n\t\t\t\tclearTimeout(target.animated);\n\t\t\t\ttarget.animated = setTimeout(function () {\n\t\t\t\t\t_css(target, 'transition', '');\n\t\t\t\t\t_css(target, 'transform', '');\n\t\t\t\t\ttarget.animated = false;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t},\n\n\t\t_offUpEvents: function () {\n\t\t\tvar ownerDocument = this.el.ownerDocument;\n\n\t\t\t_off(document, 'touchmove', this._onTouchMove);\n\t\t\t_off(document, 'pointermove', this._onTouchMove);\n\t\t\t_off(ownerDocument, 'mouseup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchend', this._onDrop);\n\t\t\t_off(ownerDocument, 'pointerup', this._onDrop);\n\t\t\t_off(ownerDocument, 'touchcancel', this._onDrop);\n\t\t\t_off(ownerDocument, 'pointercancel', this._onDrop);\n\t\t\t_off(ownerDocument, 'selectstart', this);\n\t\t},\n\n\t\t_onDrop: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\toptions = this.options;\n\n\t\t\tclearInterval(this._loopId);\n\t\t\tclearInterval(autoScroll.pid);\n\t\t\tclearTimeout(this._dragStartTimer);\n\n\t\t\t// Unbind events\n\t\t\t_off(document, 'mousemove', this._onTouchMove);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(document, 'drop', this);\n\t\t\t\t_off(el, 'dragstart', this._onDragStart);\n\t\t\t}\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (evt) {\n\t\t\t\tif (moved) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t!options.dropBubble && evt.stopPropagation();\n\t\t\t\t}\n\n\t\t\t\tghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);\n\n\t\t\t\tif (rootEl === parentEl || Sortable.active.lastPullMode !== 'clone') {\n\t\t\t\t\t// Remove clone\n\t\t\t\t\tcloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);\n\t\t\t\t}\n\n\t\t\t\tif (dragEl) {\n\t\t\t\t\tif (this.nativeDraggable) {\n\t\t\t\t\t\t_off(dragEl, 'dragend', this);\n\t\t\t\t\t}\n\n\t\t\t\t\t_disableDraggable(dragEl);\n\t\t\t\t\tdragEl.style['will-change'] = '';\n\n\t\t\t\t\t// Remove class's\n\t\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, false);\n\t\t\t\t\t_toggleClass(dragEl, this.options.chosenClass, false);\n\n\t\t\t\t\t// Drag stop event\n\t\t\t\t\t_dispatchEvent(this, rootEl, 'unchoose', dragEl, rootEl, oldIndex);\n\n\t\t\t\t\tif (rootEl !== parentEl) {\n\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t// Add event\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'add', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// Remove event\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'remove', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t\t// drag from one list and drop into another\n\t\t\t\t\t\t\t_dispatchEvent(null, parentEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (dragEl.nextSibling !== nextEl) {\n\t\t\t\t\t\t\t// Get the index of the dragged element within its parent\n\t\t\t\t\t\t\tnewIndex = _index(dragEl, options.draggable);\n\n\t\t\t\t\t\t\tif (newIndex >= 0) {\n\t\t\t\t\t\t\t\t// drag & drop within the same list\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'update', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Sortable.active) {\n\t\t\t\t\t\t/* jshint eqnull:true */\n\t\t\t\t\t\tif (newIndex == null || newIndex === -1) {\n\t\t\t\t\t\t\tnewIndex = oldIndex;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_dispatchEvent(this, rootEl, 'end', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t// Save sorting\n\t\t\t\t\t\tthis.save();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._nulling();\n\t\t},\n\n\t\t_nulling: function() {\n\t\t\trootEl =\n\t\t\tdragEl =\n\t\t\tparentEl =\n\t\t\tghostEl =\n\t\t\tnextEl =\n\t\t\tcloneEl =\n\t\t\tlastDownEl =\n\n\t\t\tscrollEl =\n\t\t\tscrollParentEl =\n\n\t\t\ttapEvt =\n\t\t\ttouchEvt =\n\n\t\t\tmoved =\n\t\t\tnewIndex =\n\n\t\t\tlastEl =\n\t\t\tlastCSS =\n\n\t\t\tputSortable =\n\t\t\tactiveGroup =\n\t\t\tSortable.active = null;\n\n\t\t\tsavedInputChecked.forEach(function (el) {\n\t\t\t\tel.checked = true;\n\t\t\t});\n\t\t\tsavedInputChecked.length = 0;\n\t\t},\n\n\t\thandleEvent: function (/**Event*/evt) {\n\t\t\tswitch (evt.type) {\n\t\t\t\tcase 'drop':\n\t\t\t\tcase 'dragend':\n\t\t\t\t\tthis._onDrop(evt);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'dragover':\n\t\t\t\tcase 'dragenter':\n\t\t\t\t\tif (dragEl) {\n\t\t\t\t\t\tthis._onDragOver(evt);\n\t\t\t\t\t\t_globalDragOver(evt);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'selectstart':\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Serializes the item into an array of string.\n\t\t * @returns {String[]}\n\t\t */\n\t\ttoArray: function () {\n\t\t\tvar order = [],\n\t\t\t\tel,\n\t\t\t\tchildren = this.el.children,\n\t\t\t\ti = 0,\n\t\t\t\tn = children.length,\n\t\t\t\toptions = this.options;\n\n\t\t\tfor (; i < n; i++) {\n\t\t\t\tel = children[i];\n\t\t\t\tif (_closest(el, options.draggable, this.el)) {\n\t\t\t\t\torder.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn order;\n\t\t},\n\n\n\t\t/**\n\t\t * Sorts the elements according to the array.\n\t\t * @param  {String[]}  order  order of the items\n\t\t */\n\t\tsort: function (order) {\n\t\t\tvar items = {}, rootEl = this.el;\n\n\t\t\tthis.toArray().forEach(function (id, i) {\n\t\t\t\tvar el = rootEl.children[i];\n\n\t\t\t\tif (_closest(el, this.options.draggable, rootEl)) {\n\t\t\t\t\titems[id] = el;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\torder.forEach(function (id) {\n\t\t\t\tif (items[id]) {\n\t\t\t\t\trootEl.removeChild(items[id]);\n\t\t\t\t\trootEl.appendChild(items[id]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Save the current sorting\n\t\t */\n\t\tsave: function () {\n\t\t\tvar store = this.options.store;\n\t\t\tstore && store.set(this);\n\t\t},\n\n\n\t\t/**\n\t\t * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\n\t\t * @param   {HTMLElement}  el\n\t\t * @param   {String}       [selector]  default: `options.draggable`\n\t\t * @returns {HTMLElement|null}\n\t\t */\n\t\tclosest: function (el, selector) {\n\t\t\treturn _closest(el, selector || this.options.draggable, this.el);\n\t\t},\n\n\n\t\t/**\n\t\t * Set/get option\n\t\t * @param   {string} name\n\t\t * @param   {*}      [value]\n\t\t * @returns {*}\n\t\t */\n\t\toption: function (name, value) {\n\t\t\tvar options = this.options;\n\n\t\t\tif (value === void 0) {\n\t\t\t\treturn options[name];\n\t\t\t} else {\n\t\t\t\toptions[name] = value;\n\n\t\t\t\tif (name === 'group') {\n\t\t\t\t\t_prepareGroup(options);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Destroy\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar el = this.el;\n\n\t\t\tel[expando] = null;\n\n\t\t\t_off(el, 'mousedown', this._onTapStart);\n\t\t\t_off(el, 'touchstart', this._onTapStart);\n\t\t\t_off(el, 'pointerdown', this._onTapStart);\n\n\t\t\tif (this.nativeDraggable) {\n\t\t\t\t_off(el, 'dragover', this);\n\t\t\t\t_off(el, 'dragenter', this);\n\t\t\t}\n\n\t\t\t// Remove draggable attributes\n\t\t\tArray.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n\t\t\t\tel.removeAttribute('draggable');\n\t\t\t});\n\n\t\t\ttouchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver), 1);\n\n\t\t\tthis._onDrop();\n\n\t\t\tthis.el = el = null;\n\t\t}\n\t};\n\n\n\tfunction _cloneHide(sortable, state) {\n\t\tif (sortable.lastPullMode !== 'clone') {\n\t\t\tstate = true;\n\t\t}\n\n\t\tif (cloneEl && (cloneEl.state !== state)) {\n\t\t\t_css(cloneEl, 'display', state ? 'none' : '');\n\n\t\t\tif (!state) {\n\t\t\t\tif (cloneEl.state) {\n\t\t\t\t\tif (sortable.options.group.revertClone) {\n\t\t\t\t\t\trootEl.insertBefore(cloneEl, nextEl);\n\t\t\t\t\t\tsortable._animate(dragEl, cloneEl);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcloneEl.state = state;\n\t\t}\n\t}\n\n\n\tfunction _closest(/**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx) {\n\t\tif (el) {\n\t\t\tctx = ctx || document;\n\n\t\t\tdo {\n\t\t\t\tif ((selector === '>*' && el.parentNode === ctx) || _matches(el, selector)) {\n\t\t\t\t\treturn el;\n\t\t\t\t}\n\t\t\t\t/* jshint boss:true */\n\t\t\t} while (el = _getParentOrHost(el));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\n\tfunction _getParentOrHost(el) {\n\t\tvar parent = el.host;\n\n\t\treturn (parent && parent.nodeType) ? parent : el.parentNode;\n\t}\n\n\n\tfunction _globalDragOver(/**Event*/evt) {\n\t\tif (evt.dataTransfer) {\n\t\t\tevt.dataTransfer.dropEffect = 'move';\n\t\t}\n\t\tevt.preventDefault();\n\t}\n\n\n\tfunction _on(el, event, fn) {\n\t\tel.addEventListener(event, fn, captureMode);\n\t}\n\n\n\tfunction _off(el, event, fn) {\n\t\tel.removeEventListener(event, fn, captureMode);\n\t}\n\n\n\tfunction _toggleClass(el, name, state) {\n\t\tif (el) {\n\t\t\tif (el.classList) {\n\t\t\t\tel.classList[state ? 'add' : 'remove'](name);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar className = (' ' + el.className + ' ').replace(R_SPACE, ' ').replace(' ' + name + ' ', ' ');\n\t\t\t\tel.className = (className + (state ? ' ' + name : '')).replace(R_SPACE, ' ');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _css(el, prop, val) {\n\t\tvar style = el && el.style;\n\n\t\tif (style) {\n\t\t\tif (val === void 0) {\n\t\t\t\tif (document.defaultView && document.defaultView.getComputedStyle) {\n\t\t\t\t\tval = document.defaultView.getComputedStyle(el, '');\n\t\t\t\t}\n\t\t\t\telse if (el.currentStyle) {\n\t\t\t\t\tval = el.currentStyle;\n\t\t\t\t}\n\n\t\t\t\treturn prop === void 0 ? val : val[prop];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!(prop in style)) {\n\t\t\t\t\tprop = '-webkit-' + prop;\n\t\t\t\t}\n\n\t\t\t\tstyle[prop] = val + (typeof val === 'string' ? '' : 'px');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _find(ctx, tagName, iterator) {\n\t\tif (ctx) {\n\t\t\tvar list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;\n\n\t\t\tif (iterator) {\n\t\t\t\tfor (; i < n; i++) {\n\t\t\t\t\titerator(list[i], i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn list;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\n\n\tfunction _dispatchEvent(sortable, rootEl, name, targetEl, fromEl, startIndex, newIndex) {\n\t\tsortable = (sortable || rootEl[expando]);\n\n\t\tvar evt = document.createEvent('Event'),\n\t\t\toptions = sortable.options,\n\t\t\tonName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n\n\t\tevt.initEvent(name, true, true);\n\n\t\tevt.to = rootEl;\n\t\tevt.from = fromEl || rootEl;\n\t\tevt.item = targetEl || rootEl;\n\t\tevt.clone = cloneEl;\n\n\t\tevt.oldIndex = startIndex;\n\t\tevt.newIndex = newIndex;\n\n\t\trootEl.dispatchEvent(evt);\n\n\t\tif (options[onName]) {\n\t\t\toptions[onName].call(sortable, evt);\n\t\t}\n\t}\n\n\n\tfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect, originalEvt, willInsertAfter) {\n\t\tvar evt,\n\t\t\tsortable = fromEl[expando],\n\t\t\tonMoveFn = sortable.options.onMove,\n\t\t\tretVal;\n\n\t\tevt = document.createEvent('Event');\n\t\tevt.initEvent('move', true, true);\n\n\t\tevt.to = toEl;\n\t\tevt.from = fromEl;\n\t\tevt.dragged = dragEl;\n\t\tevt.draggedRect = dragRect;\n\t\tevt.related = targetEl || toEl;\n\t\tevt.relatedRect = targetRect || toEl.getBoundingClientRect();\n\t\tevt.willInsertAfter = willInsertAfter;\n\n\t\tfromEl.dispatchEvent(evt);\n\n\t\tif (onMoveFn) {\n\t\t\tretVal = onMoveFn.call(sortable, evt, originalEvt);\n\t\t}\n\n\t\treturn retVal;\n\t}\n\n\n\tfunction _disableDraggable(el) {\n\t\tel.draggable = false;\n\t}\n\n\n\tfunction _unsilent() {\n\t\t_silent = false;\n\t}\n\n\n\t/** @returns {HTMLElement|false} */\n\tfunction _ghostIsLast(el, evt) {\n\t\tvar lastEl = el.lastElementChild,\n\t\t\trect = lastEl.getBoundingClientRect();\n\n\t\t// 5 — min delta\n\t\t// abs — нельзя добавлять, а то глюки при наведении сверху\n\t\treturn (evt.clientY - (rect.top + rect.height) > 5) ||\n\t\t\t(evt.clientX - (rect.left + rect.width) > 5);\n\t}\n\n\n\t/**\n\t * Generate id\n\t * @param   {HTMLElement} el\n\t * @returns {String}\n\t * @private\n\t */\n\tfunction _generateId(el) {\n\t\tvar str = el.tagName + el.className + el.src + el.href + el.textContent,\n\t\t\ti = str.length,\n\t\t\tsum = 0;\n\n\t\twhile (i--) {\n\t\t\tsum += str.charCodeAt(i);\n\t\t}\n\n\t\treturn sum.toString(36);\n\t}\n\n\t/**\n\t * Returns the index of an element within its parent for a selected set of\n\t * elements\n\t * @param  {HTMLElement} el\n\t * @param  {selector} selector\n\t * @return {number}\n\t */\n\tfunction _index(el, selector) {\n\t\tvar index = 0;\n\n\t\tif (!el || !el.parentNode) {\n\t\t\treturn -1;\n\t\t}\n\n\t\twhile (el && (el = el.previousElementSibling)) {\n\t\t\tif ((el.nodeName.toUpperCase() !== 'TEMPLATE') && (selector === '>*' || _matches(el, selector))) {\n\t\t\t\tindex++;\n\t\t\t}\n\t\t}\n\n\t\treturn index;\n\t}\n\n\tfunction _matches(/**HTMLElement*/el, /**String*/selector) {\n\t\tif (el) {\n\t\t\tselector = selector.split('.');\n\n\t\t\tvar tag = selector.shift().toUpperCase(),\n\t\t\t\tre = new RegExp('\\\\s(' + selector.join('|') + ')(?=\\\\s)', 'g');\n\n\t\t\treturn (\n\t\t\t\t(tag === '' || el.nodeName.toUpperCase() == tag) &&\n\t\t\t\t(!selector.length || ((' ' + el.className + ' ').match(re) || []).length == selector.length)\n\t\t\t);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tfunction _throttle(callback, ms) {\n\t\tvar args, _this;\n\n\t\treturn function () {\n\t\t\tif (args === void 0) {\n\t\t\t\targs = arguments;\n\t\t\t\t_this = this;\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\tcallback.call(_this, args[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback.apply(_this, args);\n\t\t\t\t\t}\n\n\t\t\t\t\targs = void 0;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t};\n\t}\n\n\tfunction _extend(dst, src) {\n\t\tif (dst && src) {\n\t\t\tfor (var key in src) {\n\t\t\t\tif (src.hasOwnProperty(key)) {\n\t\t\t\t\tdst[key] = src[key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn dst;\n\t}\n\n\tfunction _clone(el) {\n\t\treturn $\n\t\t\t? $(el).clone(true)[0]\n\t\t\t: (Polymer && Polymer.dom\n\t\t\t\t? Polymer.dom(el).cloneNode(true)\n\t\t\t\t: el.cloneNode(true)\n\t\t\t);\n\t}\n\n\tfunction _saveInputCheckedState(root) {\n\t\tvar inputs = root.getElementsByTagName('input');\n\t\tvar idx = inputs.length;\n\n\t\twhile (idx--) {\n\t\t\tvar el = inputs[idx];\n\t\t\tel.checked && savedInputChecked.push(el);\n\t\t}\n\t}\n\n\t// Fixed #973: \n\t_on(document, 'touchmove', function (evt) {\n\t\tif (Sortable.active) {\n\t\t\tevt.preventDefault();\n\t\t}\n\t});\n\n\ttry {\n\t\twindow.addEventListener('test', null, Object.defineProperty({}, 'passive', {\n\t\t\tget: function () {\n\t\t\t\tcaptureMode = {\n\t\t\t\t\tcapture: false,\n\t\t\t\t\tpassive: false\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t} catch (err) {}\n\n\t// Export utils\n\tSortable.utils = {\n\t\ton: _on,\n\t\toff: _off,\n\t\tcss: _css,\n\t\tfind: _find,\n\t\tis: function (el, selector) {\n\t\t\treturn !!_closest(el, selector, el);\n\t\t},\n\t\textend: _extend,\n\t\tthrottle: _throttle,\n\t\tclosest: _closest,\n\t\ttoggleClass: _toggleClass,\n\t\tclone: _clone,\n\t\tindex: _index\n\t};\n\n\n\t/**\n\t * Create sortable instance\n\t * @param {HTMLElement}  el\n\t * @param {Object}      [options]\n\t */\n\tSortable.create = function (el, options) {\n\t\treturn new Sortable(el, options);\n\t};\n\n\n\t// Export\n\tSortable.version = '1.6.1';\n\treturn Sortable;\n});\n\n\n\n// WEBPACK FOOTER //\n// /home/srodk/Repos/SimpleOekaki/node_modules/sortablejs/Sortable.js","\n\nimport CANVAS_V_SHADER from '../glsl/canvas.vsh';\nimport CANVAS_F_SHADER from '../glsl/canvas.fsh';\nimport LAYER_V_SHADER from '../glsl/layer.vsh';\nimport LAYER_F_SHADER from '../glsl/layer.fsh';\n\nconst VERSION = '0.2.1';\nconst MIN_BRUSH_SIZE = 1;\nconst MAX_BRUSH_SIZE = 31;\nconst DEFAULT_BRUSH_SIZE = 1;\n\nconst DEFAULT_BACKGROUND_COLOR = [1, 1, 1];\nconst DEFAULT_LAYER_COLOR = [0, 0, 0];\n\nclass SimpleOekakiCanvas {\n  // Constants\n  static get VERSION() { return VERSION; }\n  static get MIN_BRUSH_SIZE() { return MIN_BRUSH_SIZE; }\n  static get MAX_BRUSH_SIZE() { return MAX_BRUSH_SIZE; }\n  static get DEFAULT_BRUSH_SIZE() { return DEFAULT_BRUSH_SIZE; }\n  static get DEFAULT_BACKGROUND_COLOR() { return DEFAULT_BACKGROUND_COLOR; }\n  static get DEFAULT_LAYER_COLOR() { return DEFAULT_LAYER_COLOR; }\n\n  constructor(div) {\n    // Drawing state\n    this._diameter = DEFAULT_BRUSH_SIZE;\n    this._backgroundColor = DEFAULT_BACKGROUND_COLOR;\n    this._currentLayer = 2;\n    this._layerOrder = [0, 1, 2];\n    this._layerColors = [DEFAULT_LAYER_COLOR, DEFAULT_LAYER_COLOR, DEFAULT_LAYER_COLOR];\n    this._layerVisibility = [1, 1, 1];\n\n    this._canvas = document.createElement('canvas');\n    this._canvas.height = 800;\n    this._canvas.width = 800;\n\n    div.appendChild(this._canvas);\n\n    // Initialize the GL context\n    this._initializeGL();\n    if (!this._gl) {\n      throw new Error('could not create webgl context');\n    }\n    this._setInputCallbacks();\n  }\n  get backgroundColor() {\n    return this._backgroundColor;\n  }\n  set backgroundColor(colorArray) {\n    this._backgroundColor = colorArray;\n    console.log('backgroundColor set:', this.backgroundColor);\n  }\n\n  get currentLayer() {\n    return this._currentLayer;\n  }\n\n  set currentLayer(id) {\n    if (id === this._currentLayer) return;\n    if (id >= 0 && id < 3) {\n      this._currentLayer = id;\n      if (this._onCurrentLayerChange) this._onCurrentLayerChange(id);\n    }\n  }\n\n  get brushSize() {\n    return this._diameter;\n  }\n\n  set brushSize(size) {\n    if (size === this._diameter) return;\n    this._diameter = size;\n    if (this._diameter < MIN_BRUSH_SIZE) {\n      this._diameter = MIN_BRUSH_SIZE;\n    }\n    if (this._diameter > MAX_BRUSH_SIZE) {\n      this._diameter = MAX_BRUSH_SIZE;\n    }\n    console.log('brush size changed to', this._diameter);\n    if (this._onBrushSizeChange) this._onBrushSizeChange(this._diameter);\n  }\n\n  getLayerColor(id) {\n    return this._layerColors[id];\n  }\n\n  setLayerColor(id, colors) {\n    this._layerColors[id] = colors;\n    if (this._onLayerColorChange) this._onLayerColorChange(id, colors);\n  }\n\n  paintLine(x0, y0, x1, y1) {\n    this._gl.useProgram(this._layerShaderProgram);\n    this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, this._canvasFBO);\n    this._gl.uniform4f(\n      this._fragmentLineUniform, Math.round(x0) + 0.5,\n      (800 - Math.round(y0)) + 0.5,\n      Math.round(x1) + 0.5,\n      (800 - Math.round(y1)) + 0.5,\n    );\n    this._gl.uniform1f(this._fragmentSizeUniform, this._diameter);\n    this._gl.drawArrays(this._gl.TRIANGLE_STRIP, 0, 4);\n  }\n  paintGL() {\n    this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\n    this._gl.useProgram(this._canvasShaderProgram);\n    this._gl.clearColor(\n      this._backgroundColor[0],\n      this._backgroundColor[1],\n      this._backgroundColor[2],\n      1.0,\n    );\n    this._gl.clear(this._gl.COLOR_BUFFER_BIT);\n    this._gl.uniform3fv(this._fragmentBackgroundColorUniform, this._backgroundColor);\n    this._gl.uniform3iv(this._fragmentLayerOrderUniform, this._layerOrder);\n    this._gl.uniform3fv(this._fragmentLayerVisibilityUniform, this._layerVisibility);\n    this._gl.uniformMatrix3fv(\n      this._fragmentLayerColorsUniform,\n      false,\n      this._layerColors[0].concat(this._layerColors[1], this._layerColors[2]),\n    );\n    this._gl.drawArrays(this._gl.TRIANGLE_STRIP, 0, 4);\n  }\n\n  _getShader(str, type) {\n    const shader = this._gl.createShader(type);\n    this._gl.shaderSource(shader, str);\n    this._gl.compileShader(shader);\n    if (!this._gl.getShaderParameter(shader, this._gl.COMPILE_STATUS)) {\n      console.log('JS:Shader compile failed');\n      console.log(this._gl.getShaderInfoLog(shader));\n      return null;\n    }\n    return shader;\n  }\n  _initBuffers() {\n    const canvasBuffer = this._gl.createBuffer();\n    this._gl.bindBuffer(this._gl.ARRAY_BUFFER, canvasBuffer);\n    this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array([\n      -1, -1,\n      1, -1,\n      -1, 1,\n      1, 1,\n    ]), this._gl.STATIC_DRAW);\n    this._gl.vertexAttribPointer(this._vertexPositionAttribute2, 2, this._gl.FLOAT, false, 0, 0);\n    this._gl.vertexAttribPointer(this._vertexPositionAttribute, 2, this._gl.FLOAT, false, 0, 0);\n\n    this._canvasFBO = this._gl.createFramebuffer();\n    this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, this._canvasFBO);\n    this._canvasFBO.width = this._canvas.width;\n    this._canvasFBO.height = this._canvas.height;\n\n    this._canvasTexture = this._gl.createTexture();\n    this._gl.bindTexture(this._gl.TEXTURE_2D, this._canvasTexture);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MAG_FILTER, this._gl.NEAREST);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MIN_FILTER, this._gl.NEAREST);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl.CLAMP_TO_EDGE);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl.CLAMP_TO_EDGE);\n    this._gl.texImage2D(\n      this._gl.TEXTURE_2D,\n      0,\n      this._gl.RGBA,\n      this._canvasFBO.width,\n      this._canvasFBO.height,\n      0,\n      this._gl.RGBA,\n      this._gl.UNSIGNED_BYTE,\n      null,\n    );\n    this._gl.framebufferTexture2D(\n      this._gl.FRAMEBUFFER,\n      this._gl.COLOR_ATTACHMENT0,\n      this._gl.TEXTURE_2D,\n      this._canvasTexture,\n      0,\n    );\n\n    this._gl.clearColor(0, 0, 0, 1);\n    this._gl.clear(this._gl.COLOR_BUFFER_BIT);\n\n    this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\n  }\n  _initShaderProgram(fsh, vsh) {\n    const vertexShader = this._getShader(vsh, this._gl.VERTEX_SHADER);\n    const fragmentShader = this._getShader(fsh, this._gl.FRAGMENT_SHADER);\n    const shaderProgram = this._gl.createProgram();\n    this._gl.attachShader(shaderProgram, vertexShader);\n    this._gl.attachShader(shaderProgram, fragmentShader);\n    this._gl.linkProgram(shaderProgram);\n    if (!this._gl.getProgramParameter(shaderProgram, this._gl.LINK_STATUS)) {\n      console.log('Could not initialise shaders');\n      console.log(this._gl.getProgramInfoLog(shaderProgram));\n    }\n    this._gl.useProgram(shaderProgram);\n    const VertexPositionAttribute = this._gl.getAttribLocation(shaderProgram, 'position');\n    this._gl.enableVertexAttribArray(VertexPositionAttribute);\n    return shaderProgram;\n  }\n  _initShaders() {\n    this._canvasShaderProgram = this._initShaderProgram(CANVAS_F_SHADER, CANVAS_V_SHADER);\n    this._fragmentBackgroundColorUniform = this._gl.getUniformLocation(this._canvasShaderProgram, 'backgroundColor');\n    this._fragmentLayerOrderUniform = this._gl.getUniformLocation(this._canvasShaderProgram, 'layerOrder');\n    this._fragmentLayerColorsUniform = this._gl.getUniformLocation(this._canvasShaderProgram, 'layerColors');\n    this._fragmentLayerVisibilityUniform = this._gl.getUniformLocation(this._canvasShaderProgram, 'layerVisibility');\n\n    this._layerShaderProgram = this._initShaderProgram(LAYER_F_SHADER, LAYER_V_SHADER);\n    this._fragmentLineUniform = this._gl.getUniformLocation(this._layerShaderProgram, 'line');\n    this._fragmentSizeUniform = this._gl.getUniformLocation(this._layerShaderProgram, 'size');\n  }\n  _setInputCallbacks() {\n    let isDown;\n    let currentMousePos;\n    const getMouse = (e) => {\n      const bbox = this._canvas.getBoundingClientRect();\n      const mx = e.clientX - (bbox.left * (this._canvas.width / bbox.width));\n      const my = e.clientY - (bbox.top * (this._canvas.height / bbox.height));\n      return { x: mx, y: my };\n    };\n\n    this._canvas.addEventListener('mousedown', (startEvent) => {\n      currentMousePos = getMouse(startEvent);\n      this.paintLine(currentMousePos.x, currentMousePos.y, currentMousePos.x, currentMousePos.y);\n      isDown = true;\n    });\n\n    document.addEventListener('mouseup', () => {\n      isDown = false;\n    });\n    document.addEventListener('mousemove', (moveEvent) => {\n      if (!isDown) return;\n      const nextPos = getMouse(moveEvent);\n      this.paintLine(currentMousePos.x, currentMousePos.y, nextPos.x, nextPos.y);\n      currentMousePos = nextPos;\n      moveEvent.preventDefault();\n    });\n\n    this._canvas.addEventListener('touchstart', (startEvent) => {\n      currentMousePos = getMouse(startEvent.targetTouches[0]);\n      this.paintLine(currentMousePos.x, currentMousePos.y, currentMousePos.x, currentMousePos.y);\n      isDown = true;\n    });\n    document.addEventListener('touchend', () => {\n      isDown = false;\n    });\n    this._canvas.addEventListener('touchmove', (moveEvent) => {\n      if (!isDown) return;\n      moveEvent.preventDefault();\n\n      const nextPos = getMouse(moveEvent.targetTouches[0]);\n\n      this.paintLine(currentMousePos.x, currentMousePos.y, nextPos.x, nextPos.y);\n      currentMousePos = nextPos;\n      moveEvent.stopPropagation();\n      moveEvent.cancelBubble = true;\n    });\n  }\n  _initializeGL() {\n    this._gl = this._canvas.getContext('webgl') || this._canvas.getContext('experimental-webgl');\n    this._gl.clearColor(0.0, 0.0, 0.0, 1.0);\n\n    this._gl.viewport(0, 0, this._canvas.width, this._canvas.height);\n\n    // Initialize the shader program\n    this._initShaders();\n    this._initBuffers();\n    const self = this;\n    setInterval(() => { self.paintGL(); }, 15);\n  }\n}\n\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = SimpleOekakiCanvas;\n}\n\nif (window) {\n  window.SimpleOekakiCanvas = SimpleOekakiCanvas;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./SimpleOekakiCanvas.js","module.exports = \"attribute vec2 position;\\nvarying vec2 Texcoord;\\nvoid main(void) {\\n  Texcoord = (position+1.0) / 2.0;\\n  gl_Position = vec4(position, 0.0, 1.0);\\n}\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../glsl/canvas.vsh\n// module id = 4\n// module chunks = 0","module.exports = \"precision mediump float;\\n\\nvarying vec2 Texcoord;\\nuniform vec3 backgroundColor;\\nuniform sampler2D imageTex;\\n\\nuniform ivec3 layerOrder;\\nuniform vec3 layerVisibility;\\nuniform mat3 layerColors;\\n\\nvoid main(void){\\n  vec4 texColor = texture2D(imageTex,Texcoord);\\n\\n  vec3 outputColor = backgroundColor;\\n\\n  for(int i = 0; i < 3; i++){\\n    int currentLayer = layerOrder[i];\\n\\n  if(currentLayer == 0){\\n      vec3 currentColor = layerColors[0];\\n      float currentSet = texColor[0];\\n      currentSet = currentSet * layerVisibility[0];\\n      outputColor = currentSet * currentColor + outputColor * (1.0-currentSet); \\n    } else if(currentLayer == 1){\\n      vec3 currentColor = layerColors[1];\\n      float currentSet = texColor[1];\\n      currentSet = currentSet * layerVisibility[1];\\n      outputColor = currentSet * currentColor + outputColor * (1.0-currentSet);\\n    } else {\\n      vec3 currentColor = layerColors[2];\\n      float currentSet = texColor[2];\\n      currentSet = currentSet * layerVisibility[2];\\n      outputColor = currentSet * currentColor + outputColor * (1.0-currentSet);\\n    }\\n  }\\n  gl_FragColor = vec4(outputColor,1.0);\\n}\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../glsl/canvas.fsh\n// module id = 5\n// module chunks = 0","module.exports = \"attribute vec2 position;\\nvoid main(void) {\\n  gl_Position = vec4(position, 0.0, 1.0);\\n}\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../glsl/layer.vsh\n// module id = 6\n// module chunks = 0","module.exports = \"precision mediump float;\\n\\nuniform vec4 line;\\nuniform float size;\\n\\nvoid main(void){\\n  float x = gl_FragCoord.x;\\n  float y = gl_FragCoord.y;\\n  \\n  float x1 = line[0];\\n  float y1 = line[1];\\n  float x2 = line[2];\\n  float y2 = line[3];\\n\\n  float A = x - x1;\\n  float B = y - y1;\\n  float C = x2 - x1;\\n  float D = y2 - y1;\\n  \\n  float dot = A * C + B * D;\\n  float len_sq = C * C + D * D;\\n  float param = -1.0;\\n  if (len_sq != 0.0) //in case of 0 length line\\n      param = dot / len_sq;\\n  \\n  float xx, yy;\\n  \\n  if (param < 0.0){\\n    xx = x1;\\n    yy = y1;\\n  } else if(param > 1.0){\\n    xx = x2;\\n    yy = y2;\\n  } else if(abs(C) > abs(D)){\\n    xx = floor(x1 + param * C) + 0.5;\\n    yy = floor(y1 + (xx - x1) / C * D) + 0.5;\\n  }else{\\n    yy = floor(y1 + param * D) + 0.5;\\n    xx = floor(x1 + (yy - y1) / D * C) +0.5;\\n  }\\n  float d = distance(vec2(x,y),vec2(xx,yy));\\n\\n  if(d > size/2.0) discard;\\n\\n  gl_FragColor = vec4(1.0,1.0,1.0,1.0);\\n}\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../glsl/layer.fsh\n// module id = 7\n// module chunks = 0","\nconst DECtoHEX = (c) => {\n  const hex = c.toString(16);\n  return hex.length === 1 ? `0${hex}` : hex;\n};\n\nconst HTMLtoRGB = htmlcolor => htmlcolor.match(/[A-Za-z0-9]{2}/g).map(v => parseInt(v, 16) / 255);\n\nconst RGBtoHTML = rgbcolor => `#${DECtoHEX(rgbcolor[0] * 255)}${DECtoHEX(rgbcolor[1] * 255)}${DECtoHEX(rgbcolor[2] * 255)}`;\n\nmodule.exports = {\n  DECtoHEX,\n  HTMLtoRGB,\n  RGBtoHTML,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./utils.js"],"sourceRoot":""}